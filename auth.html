<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è - –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¢–µ—Å—Ç–∏</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div
        style="min-height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);">
        <div
            style="background: white; padding: 2rem; border-radius: 1rem; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 400px; width: 100%;">
            <h1 style="text-align: center; color: var(--primary); margin-bottom: 2rem;">üéì –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¢–µ—Å—Ç–∏</h1>

            <div id="loginForm">
                <h2 style="margin-bottom: 1rem;">–í—Ö—ñ–¥</h2>
                <input type="email" id="loginEmail" placeholder="Email"
                    style="width: 100%; padding: 0.75rem; margin-bottom: 1rem; border: 1px solid var(--border); border-radius: 0.5rem;">
                <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å"
                    style="width: 100%; padding: 0.75rem; margin-bottom: 1rem; border: 1px solid var(--border); border-radius: 0.5rem;">
                <button onclick="login()"
                    style="width: 100%; padding: 0.75rem; background: var(--primary); color: white; border: none; border-radius: 0.5rem; cursor: pointer; margin-bottom: 1rem;">–£–≤—ñ–π—Ç–∏</button>
                <p style="text-align: center;">–ù–µ–º–∞—î –∞–∫–∞—É–Ω—Ç—É? <a href="#" onclick="showRegister(); return false;"
                        style="color: var(--primary);">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—å</a></p>
            </div>

            <div id="registerForm" style="display: none;">
                <h2 style="margin-bottom: 1rem;">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h2>
                <input type="email" id="registerEmail" placeholder="Email"
                    style="width: 100%; padding: 0.75rem; margin-bottom: 1rem; border: 1px solid var(--border); border-radius: 0.5rem;">
                <input type="password" id="registerPassword" placeholder="–ü–∞—Ä–æ–ª—å (–º—ñ–Ω. 6 —Å–∏–º–≤–æ–ª—ñ–≤)"
                    style="width: 100%; padding: 0.75rem; margin-bottom: 1rem; border: 1px solid var(--border); border-radius: 0.5rem;">
                <button onclick="register()"
                    style="width: 100%; padding: 0.75rem; background: var(--secondary); color: white; border: none; border-radius: 0.5rem; cursor: pointer; margin-bottom: 1rem;">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—å</button>
                <p style="text-align: center;">–í–∂–µ —î –∞–∫–∞—É–Ω—Ç? <a href="#" onclick="showLogin(); return false;"
                        style="color: var(--primary);">–£–≤—ñ–π—Ç–∏</a></p>
            </div>

            <div id="message" style="margin-top: 1rem; padding: 0.75rem; border-radius: 0.5rem; display: none;"></div>
        </div>
    </div>

    <script>
        function showRegister() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            hideMessage();
        }

        function showLogin() {
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
            hideMessage();
        }

        function showMessage(text, isError = false) {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.style.display = 'block';
            msg.style.background = isError ? '#fee2e2' : '#d1fae5';
            msg.style.color = isError ? '#991b1b' : '#065f46';
        }

        function hideMessage() {
            document.getElementById('message').style.display = 'none';
        }

        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                showMessage('–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è', true);
                return;
            }

            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email,
                        password
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('userId', data.userId);
                    window.location.href = '/index.html';
                } else {
                    showMessage(data.message || '–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É', true);
                }
            } catch (error) {
                showMessage('–ü–æ–º–∏–ª–∫–∞ –∑\'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º', true);
            }
        }

        async function register() {
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;

            if (!email || !password) {
                showMessage('–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è', true);
                return;
            }

            if (password.length < 6) {
                showMessage('–ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ –º—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤', true);
                return;
            }

            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email,
                        password
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('userId', data.userId);
                    window.location.href = '/index.html';
                } else {
                    showMessage(data.message || '–ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó', true);
                }
            } catch (error) {
                showMessage('–ü–æ–º–∏–ª–∫–∞ –∑\'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º', true);
            }
        }

        document.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                if (document.getElementById('loginForm').style.display !== 'none') {
                    login();
                } else {
                    register();
                }
            }
        });
    </script>
</body>

</html>